---
title: "thesis_growth"
author: "Kane Russell"
date: "9/9/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2)
library(nlme)
library(dplyr)
growth <- 
  read.csv("TAYSR_CompiledGrowthData_2013_2018.csv")
head(growth)
```


### Initial Data Visualization

```{r}
ANNINC_boxplot <- 
  ggplot(growth) + 
  geom_boxplot(aes(x = TREATMENT, y = ANN_INC), varwidth = TRUE)
ANNINC_boxplot
```

```{r}
RGR_boxplot <- 
  ggplot(growth) + 
  geom_boxplot(aes(x = TREATMENT, y = RGR), varwidth = TRUE)
RGR_boxplot
```

```{r}
BAI_boxplot <- 
  ggplot(growth) + 
  geom_boxplot(aes(x = TREATMENT, y = BAI), varwidth = TRUE)
BAI_boxplot
```


```{r}
DBH_2013_hist <- 
  ggplot(growth) + 
  geom_histogram(aes(x = DBH_2013), binwidth = 1) 
DBH_2013_hist
```

```{r}
DBH_2018_hist <- 
  ggplot(growth) + 
  geom_histogram(aes(x = DBH_2018), binwidth = 1)
DBH_2018_hist
```

```{r}
PVCS_densityplot <-
  ggplot(growth) + 
  geom_density(aes(x = PVCS_2013)) + 
  geom_density(aes(x = PVCS_2018), color = "red") + 
  xlab("PVCS")
PVCS_densityplot
```


```{r}
mean_ANN_INC <- summarize(group_by(growth, TREATMENT), mean_RGR = mean(ANN_INC))
mean_ANN_INC
```


```{r}
ANN_INC_by_trt <- 
  ggplot() + 
  geom_boxplot(data = growth, aes(x = TREATMENT, y = ANN_INC, group = COMPGAP)) + 
  geom_point(data = mean_ANN_INC, aes(x = TREATMENT, y = mean_RGR), color = "red", shape = 4, size = 4)
ANN_INC_by_trt
```
```{r}
mean_RGR <- summarize(group_by(growth, TREATMENT), mean_RGR = mean(RGR))
mean_RGR
```


```{r}
RGR_by_trt <- 
  ggplot() + 
  geom_boxplot(data = growth, aes(x = TREATMENT, y = RGR, group = COMPGAP)) + 
  geom_point(data = mean_RGR, aes(x = TREATMENT, y = mean_RGR), color = "red", shape = 4, size = 4)
RGR_by_trt
```


```{r}
mean_BAI <- summarize(group_by(growth, TREATMENT), mean_BAI = mean(BAI))
mean_BAI
BAI_by_trt <- 
  ggplot() + 
  geom_boxplot(data = growth, aes(x = TREATMENT, y = BAI, group = COMPGAP)) + 
  geom_point(data = mean_BAI, aes(x = TREATMENT, y = mean_BAI), color = "red", shape = 4, size = 4)
BAI_by_trt
```


```{r}
ANN_INC_spp <- 
  ggplot(growth) + 
  geom_boxplot(aes(x = SPECIES, y = ANN_INC))
ANN_INC_spp

RGR_spp <- 
  ggplot(growth) + 
  geom_boxplot(aes(x = SPECIES, y = RGR))
RGR_spp

BAI_spp <- 
  ggplot(growth) + 
  geom_boxplot(aes(x = SPECIES, y = BAI))
BAI_spp
```



### Modeling

```{r}
fit1 <- lm(ANN_INC ~ TREATMENT + SPECIES, data = growth)
plot(resid(fit1) ~ growth$TREATMENT)
plot(resid(fit1) ~ growth$SPECIES)
drop1(fit1, test = "F")
```


